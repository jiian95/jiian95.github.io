<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Jiian">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Jiian">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jiian">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Jiian </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Jiian</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/13/sgu-103/" itemprop="url">
                  Traffic Lights - SGU 103
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-13T20:40:19+08:00" content="2016-03-13">
              2016-03-13
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p><a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=103" target="_blank" rel="external">Traffic Lights</a></p>
<p>Time limit per test: 0.25 second(s)<br>Memory limit: 4096 kilobytes<br>input: standard<br>output: standard</p>
<p>In the city of Dingilville the traffic is arranged in an unusual way. There are junctions and roads connecting the junctions. There is at most one road between any two different junctions. There is no road connecting a junction to itself. Travel time for a road is the same for both directions. At every junction there is a single traffic light that is either blue or purple at any moment. The color of each light alternates periodically: blue for certain duration and then purple for another duration. Traffic is permitted to travel down the road between any two junctions, if and only if the lights at both junctions are the same color at the moment of departing from one junction for the other. If a vehicle arrives at a junction just at the moment the lights switch it must consider the new colors of lights. Vehicles are allowed to wait at the junctions. You are given the city map which shows:<br>the travel times for all roads (integers)<br>the durations of the two colors at each junction (integers)<br>and the initial color of the light and the remaining time (integer) for this color to change at each junction. </p>
<p>Your task is to find a path which takes the minimum time from a given source junction to a given destination junction for a vehicle when the traffic starts. In case more than one such path exists you are required to report only one of them.</p>
<p><strong>Input</strong><br>The first line contains two numbers: The id-number of the source junction and the id-number of the destination junction. The second line contains two numbers: N, M. The following N lines contain information on N junctions. The (i+2)’th line of the input file holds information about the junction i : Ci, riC, tiB, tiP where Ci is either B for blue or P for purple, indicating the initial color of the light at the junction i. Finally, the next M lines contain information on M roads. Each line is of the form: i, j, lij where i and j are the id-numbers of the junctions which are connected by this road. 2 ≤ N ≤ 300 where N is the number of junctions. The junctions are identified by integers 1 through N. These numbers are called id-numbers. 1 ≤ M ≤ 14000 where M is the number of roads. 1 ≤ lij ≤ 100 where lij is the time required to move from junction i to j using the road that connects i and j. 1 ≤ tiC ≤ 100 where tiC is the duration of the color c for the light at the junction i. The index c is either ‘B’ for blue or ‘P’ for purple. 1 ≤ riC ≤ tiC where riC is the remaining time for the initial color c at junction i. </p>
<p><strong>Output</strong><br>If a path exists:<br>The first line will contain the time taken by a minimum-time path from the source junction to the destination junction.<br>Second line will contain the list of junctions that construct the minimum-time path you have found. You have to write the junctions to the output file in the order of travelling. Therefore the first integer in this line must be the id-number of the source junction and the last one the id-number of the destination junction. </p>
<p>If a path does not exist:<br>A single line containing only the integer 0. </p>
<p><strong>sample input</strong><br>1 4<br>4 5<br>B 2 16 99<br>P 6 32 13<br>P 2 87 4<br>P 38 96 49<br>1 2 4<br>1 3 40<br>2 3 75<br>2 4 76<br>3 4 77<br><strong>sample output</strong><br>127<br>1 2 4</p>
<h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>有n个路口，m条路，每个路口有个信号灯有蓝色和紫色两种颜色，当一条路所连接的两个路口亮同一颜色的灯时，可以通过这条路，问起点到终点的最短时间。</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>如果没有交通信号灯的话，就是一题裸最短路，现在多了信号灯之后就变得恶心很多<br>我们知道对于一个路口，它的一个周期T = t[B] + t[P]<br>我们可以调整每个节点的r[i]，使得r[i]秒过后开始新的周期，<br>Func trip(u, v, t) 表示在t秒时u-&gt;v在路口需要等待的时间，注意无限循环等待的情况，其它的就是裸最短路了</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> node &#123;</span><br><span class="line">  <span class="keyword">int</span> r, t[<span class="number">2</span>], s;</span><br><span class="line">  node (<span class="keyword">int</span> c = <span class="number">0</span>, <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">int</span> t0 = <span class="number">0</span>, <span class="keyword">int</span> t1 = <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;r = r + (c ? <span class="number">0</span> : t1);</span><br><span class="line">    <span class="keyword">this</span>-&gt;t[<span class="number">0</span>] = t0;</span><br><span class="line">    <span class="keyword">this</span>-&gt;t[<span class="number">1</span>] = t1;</span><br><span class="line">    <span class="keyword">this</span>-&gt;s = t0 + t1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; d[<span class="number">310</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">modul</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (a % m + m) % m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">trip</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> x = modul(t - d[u].r, d[u].s);</span><br><span class="line">  <span class="keyword">int</span> y = modul(t - d[v].r, d[v].s);</span><br><span class="line">  <span class="keyword">int</span> a = x &gt;= d[u].t[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">int</span> b = y &gt;= d[v].t[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (a == b) <span class="keyword">return</span> t;</span><br><span class="line">  <span class="keyword">int</span> ta = modul((a ? d[u].s : d[u].t[<span class="number">0</span>]) - x, d[u].s);</span><br><span class="line">  <span class="keyword">int</span> tb = modul((b ? d[v].s : d[v].t[<span class="number">0</span>]) - y, d[v].s);</span><br><span class="line">  <span class="keyword">if</span> (ta == tb &amp;&amp; d[u].t[a] == d[v].t[b] &amp;&amp; d[u].t[!a] == d[v].t[!b]) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">int</span> tt = ta == tb ? d[u].t[!a] == d[v].t[!b] ? min(d[u].t[a], d[v].t[b]) + d[u].t[!a] + ta : min(d[u].t[!a], d[v].t[!b]) + ta : min(ta, tb);</span><br><span class="line">  <span class="keyword">return</span> tt + t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;pii&gt; G[<span class="number">310</span>];</span><br><span class="line"><span class="keyword">int</span> w[<span class="number">310</span>], pre[<span class="number">310</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dij</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(w, <span class="number">0xff</span>, <span class="keyword">sizeof</span> w);</span><br><span class="line">  w[s] = <span class="number">0</span>;</span><br><span class="line">  pre[s] = <span class="number">-1</span>;</span><br><span class="line">  priority_queue &lt;pii, <span class="built_in">vector</span> &lt;pii&gt;, greater &lt;pii&gt; &gt; q;</span><br><span class="line">  q.push(pii(<span class="number">0</span>, s));</span><br><span class="line">  <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">    <span class="keyword">int</span> a = q.top().first, u = q.top().second;</span><br><span class="line">    q.pop();</span><br><span class="line">    <span class="keyword">if</span> (w[u] &lt; a) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (u == t) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; x : G[u]) &#123;</span><br><span class="line">      <span class="keyword">int</span> v = x.first, cost = x.second;</span><br><span class="line">      <span class="keyword">int</span> f = trip(u, v, a);</span><br><span class="line">      <span class="keyword">if</span> (f == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">      cost += f;</span><br><span class="line">      <span class="keyword">if</span> (w[v] == <span class="number">-1</span> || cost &lt; w[v]) &#123;</span><br><span class="line">        w[v] = cost;</span><br><span class="line">        pre[v] = u;</span><br><span class="line">        q.push(pii(cost, v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> s, t;</span><br><span class="line">  <span class="keyword">int</span> n, m;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;s, &amp;t);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">    <span class="keyword">char</span> foo[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">int</span> r, t0, t1;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s %d %d %d"</span>, foo, &amp;r, &amp;t0, &amp;t1);</span><br><span class="line">    d[i] = node(foo[<span class="number">0</span>] == <span class="string">'P'</span>, r, t0, t1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (m --) &#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].push_back(pii(v, w));</span><br><span class="line">    G[v].push_back(pii(u, w));</span><br><span class="line">  &#125;</span><br><span class="line">  dij(s, t);</span><br><span class="line">  <span class="keyword">if</span> (w[t] == <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, w[t]);</span><br><span class="line">  <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">  <span class="keyword">while</span> (~ t) &#123;</span><br><span class="line">    ans.push_back(t);</span><br><span class="line">    t = pre[t];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (ans.size()) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans.back());</span><br><span class="line">    ans.pop_back();</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">" \n"</span>[ans.empty()]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/12/sgu-101/" itemprop="url">
                  Domino - SGU 101
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-12T23:46:25+08:00" content="2016-03-12">
              2016-03-12
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p><a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=101" target="_blank" rel="external">Domino</a></p>
<p>time limit per test: 0.25 sec.<br>memory limit per test: 4096 KB</p>
<p>Dominoes – game played with small, rectangular blocks of wood or other material, each identified by a number of dots, or pips, on its face. The blocks usually are called bones, dominoes, or pieces and sometimes men, stones, or even cards.<br>The face of each piece is divided, by a line or ridge, into two squares, each of which is marked as would be a pair of dice…</p>
<p>The principle in nearly all modern dominoes games is to match one end of a piece to another that is identically or reciprocally numbered.</p>
<p>ENCYCLOPÆDIA BRITANNICA</p>
<p>Given a set of domino pieces where each side is marked with two digits from 0 to 6. Your task is to arrange pieces in a line such way, that they touch through equal marked sides. It is possible to rotate pieces changing left and right side.</p>
<p><strong>Input</strong></p>
<p>The first line of the input contains a single integer N (1 ≤ N ≤ 100) representing the total number of pieces in the domino set. The following N lines describe pieces. Each piece is represented on a separate line in a form of two digits from 0 to 6 separated by a space.</p>
<p><strong>Output</strong></p>
<p>Write “No solution” if it is impossible to arrange them described way. If it is possible, write any of way. Pieces must be written in left-to-right order. Every of N lines must contains number of current domino piece and sign “+” or “-“ (first means that you not rotate that piece, and second if you rotate it).</p>
<p><strong>Sample Input</strong></p>
<p> 5<br>1 2<br>2 4<br>2 4<br>6 4<br>2 1<br><strong>Sample Output</strong></p>
<p>2 -<br>5 +<br>1 +<br>3 +<br>4 -</p>
<h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给你一些多米诺骨牌，每块的两部分都标记上 0 到 6 的号码，你的任务是把这些骨牌排列在一条直线上，使得相邻骨牌的相邻部分有同样的号码。骨牌可以左右翻转。</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>很水的一题，我不知道为什么貌似我的输出顺序有问题，一直wa，最后照着别人的AC代码改了下才过的。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>code:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> node &#123;</span><br><span class="line">  <span class="keyword">int</span> a, i;</span><br><span class="line">  <span class="keyword">char</span> d;</span><br><span class="line">  node (<span class="keyword">int</span> a = <span class="number">0</span>, <span class="keyword">int</span> i = <span class="number">0</span>, <span class="keyword">char</span> d = <span class="number">0</span>) : a(a), i(i), d(d) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;node&gt; v[<span class="number">10</span>], ans;</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; x : v[k]) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!vis[x.i]) &#123;</span><br><span class="line">      vis[x.i] = <span class="number">1</span>;</span><br><span class="line">      dfs(x.a);</span><br><span class="line">      ans.push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> n;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">  <span class="keyword">int</span> st;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">    <span class="keyword">int</span> a, b;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;a, &amp;b);</span><br><span class="line">    st = a;</span><br><span class="line">    v[a].push_back(node(b, i, <span class="string">'+'</span>));</span><br><span class="line">    v[b].push_back(node(a, i, <span class="string">'-'</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i ++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (v[i].size() &amp; <span class="number">1</span>) cnt ++, st = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (cnt &gt; <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"No solution"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  dfs(st);</span><br><span class="line">  <span class="keyword">if</span> (ans.size() != n) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"No solution"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (ans.size()) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d %c\n"</span>, ans.back().i, ans.back().d);</span><br><span class="line">    ans.pop_back();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/12/FFT/" itemprop="url">
                  FFT
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-12T17:47:49+08:00" content="2016-03-12">
              2016-03-12
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>先上结论，FFT就是用分治的方法将求卷积的复杂度优化为O(nlogn)</strong><br>前段时间codeforces出了一题要用FFT求卷积的题之后，就一直想学习FFT，<br>看了《算法导论》和其它一些大神的博客之后也大致了解了FFT是个啥。</p>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p>先简单介绍下卷积：<br>假设有两个关于x的多项式 $$A(x) = a_ix^i$$ $$B(x) = b_ix^i$$<br>将它们相乘得到 $$C(x) = c_ix^i$$<br>对于系数数组<strong>a[]</strong> <strong>b[]</strong>, 乘积的系数数组<strong>c[]</strong>就是它们的卷积<br>通过中学的知识我们可以知道<br>$$c_i = \sum_{j=0}^na_ib_{i-j}$$<br>其中c[i]有n项，那么这种求卷积的方法的复杂度就是<strong>O(n^2)</strong><br>对于稍微大一点点的n，这种方法就GG了<br>所以这时候我们的FFT就登场了，通过FFT我们可以在<strong>O(nlogn)</strong>内得到两个数组的卷积</p>
<p>这里就需要了解另一个概念：点值表达式<br>比如对于上面的多项式A(x)，当x=xk时，A(xk)=yk，(xk,yk)就是它的一个点值表达式<br>易得$$C(x_k) = A(x_k)B(x_k)$$<br>所以如果我们能够得到A，B的点值表达式，那么我们就可以在<strong>O(n)</strong>内求出C<br>DFT：<br>DFT是指x取单位n次根时，将多项式转换为点值表达式的方法，其复杂度为<strong>O(n^2)</strong><br>FFT:<br>FFT是指用分治的方法将DFT的复杂度优化为O(nlogn)，下面是公式<br>$$A^{[0]}(x) = a_0 + a_2x + … + a_nx^{n-1}$$<br>$$A^{[1]}(x) = a_1 + a_3x + … + {a_{n-1}}x^{n-1}$$<br>$$A(x) = A^{[0]}(x^2) + xA^{[1]}(x^2)$$<br>∴ y[k] = y[0][k] + x[k]<em>y[1][k]<br>　　　＝ y[0][k] + wn^k</em>y[1][k]<br>　y[k + n/2] = y[0][k] + wn^(k + n/2)<em>y[1][k]<br>　　　　　　＝ y[0][k] - wn^k </em> y[1][k]<br>　（这里运用到了消去引理和折半引理，具体参考《算法导论》）</p>
<p>于是复杂度的问题就解决了，我们可以在O(nlogn)内求得c[]数组：<br>A(x) = FFT(a[])<br>B(x) = FFT(b[])<br>C(x) = A(x)*B(x)<br>c[] = FFT^-1(C(x))</p>
<p>其中还有一些细节可以参考下《算法导论》（不过我认为FFT只要大致了解内容会用模板就行）</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="递归版FFT"><a href="#递归版FFT" class="headerlink" title="递归版FFT"></a>递归版FFT</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">complex</span> &lt;<span class="keyword">double</span>&gt; a[], <span class="keyword">int</span> n, <span class="keyword">int</span> on)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">complex</span> &lt;<span class="keyword">double</span>&gt; a0[n &gt;&gt; <span class="number">1</span>], a1[n &gt;&gt; <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n / <span class="number">2</span>; i ++) &#123;</span><br><span class="line">    a0[i] = a[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    a1[i] = a[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  FFT(a0, n &gt;&gt; <span class="number">1</span>, on);</span><br><span class="line">  FFT(a1, n &gt;&gt; <span class="number">1</span>, on);</span><br><span class="line">  <span class="keyword">complex</span> &lt;<span class="keyword">double</span>&gt; wn(<span class="built_in">cos</span>(<span class="number">2</span> * pi / n), <span class="built_in">sin</span>(on * <span class="number">2</span> * pi / n)), w(<span class="number">1</span>, <span class="number">0</span>), t;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n / <span class="number">2</span>; i ++) &#123;</span><br><span class="line">    a[i] = a0[i] + w * a1[i];</span><br><span class="line">    a[i + n / <span class="number">2</span>] = a0[i] - w * a1[i];</span><br><span class="line">    w *= wn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以发现，例如在0~7这8个数中<br>原数组：    0  1  2  3  4  5  6  7<br>折半一次：  0  2  4  6，1  3  5  7<br>折半二次：  0  4，2  6，1  5，3  7</p>
<p>原数组二进制表示：  000， 001， 010， 011， 100， 101， 110， 111<br>终数组二进制表示：  000， 100， 010， 110， 001， 101， 011， 111</p>
<p>最终数组对应位置的数是原数组的二进制取反</p>
<h4 id="非递归版FFT"><a href="#非递归版FFT" class="headerlink" title="非递归版FFT"></a>非递归版FFT</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">struct Complex &#123;</span><br><span class="line">  double i, r;</span><br><span class="line">  Complex(double r = 0, double i = 0) : r(r), i(i) &#123;&#125;;</span><br><span class="line">  Complex operator + (const Complex &amp; a) const &#123;</span><br><span class="line">    return Complex(r + a.r, i + a.i);</span><br><span class="line">  &#125;</span><br><span class="line">  Complex operator - (const Complex &amp; a) const &#123;</span><br><span class="line">    return Complex(r - a.r, i - a.i);</span><br><span class="line">  &#125;</span><br><span class="line">  Complex operator * (const Complex &amp; a) const &#123;</span><br><span class="line">    return Complex(r * a.r - i * a.i, i * a.r + r * a.i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">void rader(Complex F[], int len) &#123;</span><br><span class="line">  for (int i = 1, j = len &gt;&gt; 1; i &lt; len - 1; i ++) &#123;</span><br><span class="line">    if (i &lt; j) swap(F[i], F[j]);</span><br><span class="line">    int k = len &gt;&gt; 1;</span><br><span class="line">    for (; j &gt;= k; k &gt;&gt;= 1) j ^= k;</span><br><span class="line">    j |= k;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void FFT(Complex F[], int len, int on) &#123;</span><br><span class="line">  rader(F, len);</span><br><span class="line">  for (int h = 2; h &lt;= len; h &lt;&lt;= 1) &#123;</span><br><span class="line">    Complex wn(cos(- on * 2 * pi / h), sin(- on * 2 * pi / h));</span><br><span class="line">    for (int j = 0; j &lt; len; j += h) &#123;</span><br><span class="line">      Complex w(1, 0);</span><br><span class="line">      for (int k = j; k &lt; j + h / 2; k ++) &#123;</span><br><span class="line">        Complex u = F[k];</span><br><span class="line">        Complex t = w * F[k + h / 2];</span><br><span class="line">        F[k] = u + t;</span><br><span class="line">        F[k + h / 2] = u - t;</span><br><span class="line">        w = w * wn;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if (on == -1)</span><br><span class="line">    for (int i = 0; i &lt; len; i ++)</span><br><span class="line">      F[i].r /= len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p><a href="http://codeforces.com/contest/632/problem/E" target="_blank" rel="external">Thief in a Shop</a></p>
<p><a href="http://codeforces.com/contest/632/submission/16670186" target="_blank" rel="external">code</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="Jiian" />
          <p class="site-author-name" itemprop="name">Jiian</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">3</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiian</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  

  



<!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
</body>
</html>
